<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Compiler</title>
</head>
<script src="../wasm_exec.js"></script>
<script>
  const go = new Go()

  WebAssembly.instantiateStreaming(
    fetch("main.wasm"),
    go.importObject
  ).then((result) => {
    go.run(result.instance)
  })
</script>
<script>
  function getInlayHints (data)  {
    let fileCode = data.in.code
    let fileName = data.in.name
    let res = getInlayHints_GO(fileName, fileCode)
    let json = JSON.parse(res)
    if(!json.ok) {
      throw new Error("can't get inlay hints")
    }
    return json.content
  }

  function getDiagnostics (data)  {
    let fileCode = data.in.code
    let fileName = data.in.name
    let res = getDiagnostics_GO(fileName, fileCode)
    let json = JSON.parse(res)
    if(!json.ok) {
      throw new Error("can't get diagnostics")
    }
    return json.content
  }


  function getCompletionItems (data)  {
    let fileCode = data.in.code
    let fileName = data.in.name
    let lineNum = data.in.line
    let res = getCompletionItems_GO(fileName, fileCode, lineNum)
    let json = JSON.parse(res)
    if(!json.ok) {
      throw new Error("can't get completion items")
    }
    return json.content
  }

  function getDefinition (data)  {
    let fileCode = data.in.code
    let fileName = data.in.name
    let res = getDefinition_GO(fileName, fileCode)
    let json = JSON.parse(res)
    if(!json.ok) {
      throw new Error("can't get definition")
    }
    return json.content
  }

  function getTypes(data) {
    let fileCode = data.in.code
    let fileName = data.in.name
    let res = getTypes_GO(fileName, fileCode)
    let json = JSON.parse(res)
    if(!json.ok) {
      throw new Error("can't get types")
    }
    return json.content
  }

</script>

<body>
</body>
</html>
