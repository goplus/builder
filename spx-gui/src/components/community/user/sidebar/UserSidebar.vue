<script setup lang="ts">
import { getUserPageRoute } from '@/router'
import { useResponsive } from '@/components/ui/responsive'
import CommunityCard from '../../CommunityCard.vue'
import UserSidebarItem from './UserSidebarItem.vue'

defineProps<{
  username: string
}>()

const emit = defineEmits<{
  close: []
}>()

const isMobile = useResponsive('mobile')
</script>

<template>
  <CommunityCard v-radar="{ name: 'User sidebar', desc: 'Sidebar navigation for user pages' }" class="user-sidebar">
    <!-- TODO: check text here -->
    <UserSidebarItem
      v-radar="{ name: 'Overview link', desc: 'Click to navigate to user overview' }"
      :to="getUserPageRoute(username, 'overview')"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path
          d="M1.5 3.79683C1.5 3.5855 1.58395 3.38283 1.73338 3.23339C1.88282 3.08396 2.08549 3.00001 2.29683 3.00001H6.81536C8.11896 3.00001 9.27701 3.62684 10.0027 4.59472C10.3734 4.09867 10.855 3.69614 11.4089 3.41926C11.9629 3.14238 12.5739 2.99881 13.1931 3.00001H17.7032C17.9145 3.00001 18.1172 3.08396 18.2666 3.23339C18.416 3.38283 18.5 3.5855 18.5 3.79683V14.9524C18.5 15.1637 18.416 15.3664 18.2666 15.5158C18.1172 15.6653 17.9145 15.7492 17.7032 15.7492H12.9148C12.6009 15.7492 12.29 15.811 12 15.9312C11.71 16.0513 11.4464 16.2274 11.2245 16.4494L10.5636 17.1091C10.4142 17.2583 10.2117 17.3422 10.0005 17.3422C9.78937 17.3422 9.58685 17.2583 9.43744 17.1091L8.77661 16.4494C8.55463 16.2274 8.2911 16.0513 8.00108 15.9312C7.71105 15.811 7.4002 15.7492 7.08628 15.7492H2.29683C2.08549 15.7492 1.88282 15.6653 1.73338 15.5158C1.58395 15.3664 1.5 15.1637 1.5 14.9524V3.79683ZM9.20371 14.7654L9.20796 9.37567L9.20583 6.98201C9.20527 6.34838 8.95317 5.7409 8.50493 5.29306C8.05669 4.84522 7.44898 4.59366 6.81536 4.59366H3.09365V14.1556H7.08521C7.83468 14.1555 8.56896 14.3669 9.20371 14.7654ZM10.8016 6.98413L10.7974 14.7633C11.4317 14.3659 12.1652 14.1553 12.9137 14.1556H16.9053V4.59366H13.1921C12.5581 4.59366 11.9501 4.84551 11.5018 5.29381C11.0535 5.74211 10.8016 6.35014 10.8016 6.98413Z"
          fill="currentColor"
        />
      </svg>
      {{ $t({ en: 'Overview', zh: '概览' }) }}
    </UserSidebarItem>
    <UserSidebarItem
      v-radar="{ name: 'Projects link', desc: 'Click to navigate to user project list' }"
      :to="getUserPageRoute(username, 'projects')"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path
          d="M7.11634 2.93311H4.01097C3.06592 2.93311 2.2998 3.69922 2.2998 4.64427V14.5685C2.2998 15.5135 3.06592 16.2796 4.01097 16.2796H15.9885C16.9335 16.2796 17.6996 15.5135 17.6996 14.5685V8.39797C17.6996 7.45292 16.9335 6.68681 15.9885 6.68681H12.0024C11.8144 6.68681 11.6328 6.61872 11.4911 6.49513L7.62765 3.12479C7.48598 3.0012 7.30434 2.93311 7.11634 2.93311Z"
          stroke="currentColor"
          stroke-width="1.44671"
        />
        <path
          d="M8.85693 4.18408L15.9886 4.18408C16.9337 4.18408 17.6998 4.9502 17.6998 5.89525V9.18902"
          stroke="currentColor"
          stroke-width="1.44671"
        />
      </svg>
      {{ $t({ en: 'Projects', zh: '项目' }) }}
    </UserSidebarItem>
    <UserSidebarItem
      v-radar="{ name: 'recordings link', desc: 'Click to navigate to user recording list' }"
      :to="getUserPageRoute(username, 'recordings')"
    >
      <svg width="20" height="20" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="2" y="3" width="12" height="10" rx="2" stroke="currentColor" stroke-width="1.5" fill="none" />
        <circle cx="8" cy="8" r="2" fill="currentColor" />
        <circle cx="12" cy="6" r="1" fill="currentColor" />
      </svg>
      {{ $t({ en: 'Recordings', zh: '录屏' }) }}
    </UserSidebarItem>
    <UserSidebarItem
      v-radar="{ name: 'Likes link', desc: 'Click to navigate to user liked projects' }"
      :to="getUserPageRoute(username, 'likes')"
    >
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M16.0254 4.82951C14.5205 3.36976 12.1131 3.29924 10.5221 4.62428C10.3706 4.75053 10.1848 4.81182 10.0002 4.8095C9.81558 4.81182 9.62984 4.75053 9.47825 4.62428C7.88727 3.29924 5.47986 3.36976 3.97495 4.82951C2.4814 6.27824 2.41309 8.57429 3.76366 10.1001C3.78351 10.1225 3.80187 10.1457 3.81875 10.1696L10.0002 16.1656L16.1816 10.1696C16.1985 10.1457 16.2169 10.1225 16.2367 10.1001C17.5873 8.57429 17.519 6.27824 16.0254 4.82951ZM17.5387 11.0397C19.3456 8.87674 19.2105 5.68991 17.1395 3.68103C15.1942 1.79416 12.1908 1.57613 10.0002 3.02191C7.80956 1.57613 4.8062 1.79416 2.86094 3.68103C0.789911 5.68991 0.654812 8.87674 2.46167 11.0397C2.49837 11.1033 2.54397 11.1621 2.59765 11.2142L9.4432 17.8543C9.75353 18.1553 10.2469 18.1553 10.5572 17.8543L17.4027 11.2142C17.4564 11.1621 17.502 11.1033 17.5387 11.0397Z"
          fill="currentColor"
          stroke="currentColor"
          stroke-width="0.1"
          stroke-linejoin="round"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M15.1002 7.68023C14.9345 7.68023 14.8031 7.54467 14.7724 7.38185C14.6509 6.73746 14.143 6.22954 13.4986 6.108C13.3358 6.07729 13.2002 5.94591 13.2002 5.78023V4.78022C13.2002 4.61454 13.3349 4.47875 13.4999 4.49408C15.028 4.63602 16.2444 5.85241 16.3863 7.38051C16.4017 7.54548 16.2659 7.68023 16.1002 7.68023H15.1002Z"
          fill="currentColor"
        />
      </svg>
      {{ $t({ en: 'Likes', zh: '喜欢的项目' }) }}
    </UserSidebarItem>
    <UserSidebarItem
      v-radar="{ name: 'Following link', desc: 'Click to navigate to user following list' }"
      :to="getUserPageRoute(username, 'following')"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path
          d="M8.34086 8.95833C6.38753 8.95833 4.79919 7.36917 4.79919 5.41667C4.79919 3.46417 6.38753 1.875 8.34086 1.875C10.2942 1.875 11.8825 3.46417 11.8825 5.41667C11.8825 7.36917 10.2942 8.95833 8.34086 8.95833ZM8.34086 3.125C7.07669 3.125 6.04919 4.1525 6.04919 5.41667C6.04919 6.68083 7.07669 7.70833 8.34086 7.70833C9.60503 7.70833 10.6325 6.68083 10.6325 5.41667C10.6325 4.1525 9.60419 3.125 8.34086 3.125ZM9.16667 18.125H5C2.985 18.125 1.875 17.0209 1.875 15.0167C1.875 12.7984 3.13 10.2083 6.66667 10.2083H10C10.71 10.2083 11.3442 10.3117 11.8867 10.515C12.21 10.6367 12.3734 10.9967 12.2517 11.32C12.13 11.6433 11.7708 11.8066 11.4466 11.685C11.0466 11.5341 10.5592 11.4583 10 11.4583H6.66667C3.38083 11.4583 3.125 14.1825 3.125 15.0167C3.125 16.3192 3.68583 16.875 5 16.875H9.16667C9.51167 16.875 9.79167 17.155 9.79167 17.5C9.79167 17.845 9.51167 18.125 9.16667 18.125ZM16.7975 18.8991C16.6375 18.8991 16.4759 18.8617 16.3267 18.7842L15 18.1017L13.6742 18.7842C13.3234 18.9642 12.9092 18.93 12.5942 18.6975C12.2817 18.4675 12.1292 18.0883 12.1967 17.7083L12.4459 16.2834L11.3484 15.235C11.0725 14.9733 10.9734 14.585 11.0884 14.2233C11.205 13.8583 11.515 13.5975 11.8967 13.5433L13.4267 13.3258L14.085 12.0191C14.2591 11.6733 14.61 11.4591 15 11.4591C15.39 11.4591 15.7409 11.6741 15.915 12.02L16.5733 13.3266L18.1033 13.5442C18.485 13.5984 18.795 13.8583 18.9116 14.2241C19.0275 14.5866 18.9283 14.9742 18.6516 15.2367L17.555 16.2842L17.805 17.7109C17.8716 18.0917 17.7183 18.47 17.4066 18.7C17.2249 18.8316 17.0117 18.8991 16.7975 18.8991ZM15 16.8209C15.1575 16.8209 15.315 16.8575 15.4592 16.9317L16.4917 17.4634L16.2983 16.3583C16.2425 16.0317 16.3508 15.7025 16.59 15.475L17.3975 14.705L16.2683 14.545C15.9441 14.4992 15.6633 14.2975 15.5183 14.0067L15.0016 12.9817L14.4842 14.0084C14.3392 14.2975 14.0584 14.4983 13.735 14.545L12.6058 14.705L13.4133 15.4759C13.6516 15.7034 13.7609 16.0325 13.7059 16.3567L13.5125 17.4634L14.545 16.9317C14.685 16.8575 14.8425 16.8209 15 16.8209ZM17.9274 14.7809H17.9358H17.9274ZM13.3658 13.4458L13.365 13.4467L13.3658 13.4458ZM16.6333 13.4442L16.6342 13.445C16.6334 13.445 16.6333 13.4442 16.6333 13.4442Z"
          fill="currentColor"
          stroke="currentColor"
          stroke-width="0.4"
        />
      </svg>
      {{ $t({ en: 'Following', zh: '正在关注' }) }}
    </UserSidebarItem>
    <UserSidebarItem
      v-radar="{ name: 'Followers link', desc: 'Click to navigate to user followers list' }"
      :to="getUserPageRoute(username, 'followers')"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path
          d="M7.50749 8.95833C5.55415 8.95833 3.96582 7.36917 3.96582 5.41667C3.96582 3.46417 5.55415 1.875 7.50749 1.875C9.46082 1.875 11.0492 3.46417 11.0492 5.41667C11.0492 7.36917 9.46082 8.95833 7.50749 8.95833ZM7.50749 3.125C6.24332 3.125 5.21582 4.1525 5.21582 5.41667C5.21582 6.68083 6.24332 7.70833 7.50749 7.70833C8.77165 7.70833 9.79915 6.68083 9.79915 5.41667C9.79915 4.1525 8.77082 3.125 7.50749 3.125ZM10.8307 18.125H4.16917C2.1525 18.125 1.04163 17.0209 1.04163 15.0159C1.04163 12.7984 2.29663 10.2083 5.83329 10.2083H9.16663C12.7033 10.2083 13.9583 12.7975 13.9583 15.0159C13.9583 17.0209 12.8474 18.125 10.8307 18.125ZM5.83329 11.4583C2.54746 11.4583 2.29163 14.1809 2.29163 15.0159C2.29163 16.3192 2.85334 16.875 4.16917 16.875H10.8307C12.1466 16.875 12.7083 16.3192 12.7083 15.0159C12.7083 14.1817 12.4525 11.4583 9.16663 11.4583H5.83329ZM13.8 9.32495C13.0425 9.32495 12.3308 9.03662 11.7966 8.51329C11.55 8.27162 11.545 7.87586 11.7867 7.62919C12.0292 7.38252 12.4249 7.3792 12.6708 7.62004C12.9699 7.91337 13.3717 8.07495 13.8 8.07495C14.7208 8.07495 15.4425 7.35414 15.4425 6.43331C15.4425 5.52831 14.7058 4.79167 13.8 4.79167C13.5433 4.79167 13.3117 4.84418 13.1108 4.94751C12.805 5.10584 12.4275 4.9842 12.2691 4.67753C12.1108 4.37086 12.2325 3.99419 12.5391 3.83586C12.9191 3.64086 13.3433 3.54167 13.8 3.54167C15.395 3.54167 16.6925 4.83914 16.6925 6.43331C16.6916 8.02748 15.395 9.32495 13.8 9.32495ZM16.3833 16.4583H15.8166C15.4716 16.4583 15.1916 16.1783 15.1916 15.8333C15.1916 15.4883 15.4716 15.2083 15.8166 15.2083H16.3833C17.3375 15.2083 17.7083 14.8417 17.7083 13.9C17.7083 13.2842 17.5191 11.275 15.0916 11.275H13.8325C13.4875 11.275 13.2075 10.995 13.2075 10.65C13.2075 10.305 13.4875 10.025 13.8325 10.025H15.0916C17.9458 10.025 18.9583 12.1125 18.9583 13.9C18.9583 15.5259 18.02 16.4583 16.3833 16.4583Z"
          fill="currentColor"
          stroke="currentColor"
          stroke-width="0.4"
        />
      </svg>
      {{ $t({ en: 'Followers', zh: '关注者' }) }}
    </UserSidebarItem>

    <!-- 移动端收缩按钮 -->
    <div v-if="isMobile" class="mobile-collapse-btn" @click="emit('close')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
      <span>{{ $t({ en: 'Collapse', zh: '收起' }) }}</span>
    </div>
  </CommunityCard>
</template>

<style lang="scss" scoped>
@import '@/components/ui/responsive';

.user-sidebar {
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  position: relative;

  width: 212px;
  @include responsive(desktop-large) {
    width: 216px;
  }

  @include responsive(mobile) {
    position: fixed;
    z-index: 999;
  }
}

.mobile-collapse-btn {
  margin-top: 12px;
  padding: 8px 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  border-radius: 6px;
  background-color: var(--ui-color-grey-100);
  cursor: pointer;
  color: var(--ui-color-text);
  font-size: 12px;

  &:hover {
    background-color: var(--ui-color-grey-200);
  }
}
</style>
