<template>
    <h1>{{ project.title }}</h1>
    <h2>Local Project</h2>
    <button @click="getLocals">getLocals</button>
    <button @click="load(item)" v-for="item in locals">{{ item }}</button>

    <input type="file" @change="add" accept=".zip">
    <button @click="project.saveToComputer">saveToComputer</button>
    <h2>EntryCode</h2>
    <p v-text="project.entryCode"></p>
    <h2>Sprites</h2>
    <p v-for="item in project.sprite.list" :key="item.name">
        <b>{{ item.name }}</b>
        <br>
        <img :src="img.url" v-for="img in item.files" alt="">
        {{ item }}
        <button @click="item.name += '!'">addName!</button>
        <button @click="project.sprite.remove(item.name)">remove</button>
    </p>
</template>

<script setup lang="ts">
import { useProjectStore } from "@/store/modules/project";
import { storeToRefs } from "pinia";
import { ref } from "vue";
const projectStore = useProjectStore();
const { project } = storeToRefs(projectStore);
const add = async (e: any) => {
    await projectStore.loadProject(e.target.files[0], e.target.files[0].name.split(".")[0]);
}
const locals = ref<string[]>([])
const getLocals = async () => {
    locals.value = await projectStore.getLocalProjects()
}
const load = async (item: string) => {
    await projectStore.loadProject(item)
}
</script>